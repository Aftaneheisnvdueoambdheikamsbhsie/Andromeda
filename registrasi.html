<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registrasi Peserta</title>
    <link rel="stylesheet" href="regist.css">
    <!-- Import Firebase SDKs -->
    <script type="module" src="./firebase-config.js"></script>
</head>
<body>
    <header>
        <div class="logo">
            <img src="adm.png" alt="Logo"> <!-- Ganti dengan URL logo Anda -->
        </div>
        <h1>Registrasi Peserta</h1>
    </header>
    
    <main>
        <div class="form-container">
            <form id="registration-form">
                <div class="form-group">
                    <label for="name">Nama:</label>
                    <input type="text" id="name" required>
                </div>
                <div class="form-group">
                    <label for="gender">Jenis Kelamin:</label>
                    <select id="gender" required>
                        <option value="Laki-laki">Laki-laki</option>
                        <option value="Perempuan">Perempuan</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="height">Tinggi Badan (cm):</label>
                    <input type="number" id="height" required>
                </div>
                <div class="form-group">
                    <label for="weight">Berat Badan (kg):</label>
                    <input type="number" id="weight" required>
                </div>
                <div class="form-group">
                    <label for="birthdate">Tanggal Lahir:</label>
                    <input type="date" id="birthdate" required>
                </div>
                <div class="form-group">
                    <label for="category">Kategori:</label>
                    <select id="category" required>
                        <option value="Dewasa">Dewasa</option>
                        <option value="Remaja">Remaja</option>
                        <option value="Anak-anak">Anak-anak</option>
                    </select>
                </div>
                <button type="submit" class="button">Daftar</button>     
           </form>
        <button class="back-button" onclick="window.location.href='home.html'">Kembali</button>
        <button class="check-data-button" onclick="window.location.href='cekdata.html'">Cek Data</button>
             
        <div id="message" style="margin-top: 20px; display: none;"></div>
        </div>
    </main>

    <footer>
        <p>&copy; 2024 Pesta Pencak Silat. All rights reserved.</p>
    </footer>

    <!-- Import Firebase database logic -->
    <script type="module">
        import { database, ref, push } from './firebase-config.js';

        const form = document.getElementById('registration-form');
        const messageDiv = document.getElementById('message');

        form.addEventListener('submit', function(event) {
            event.preventDefault();

            const nama = document.getElementById('name').value;
            const jk = document.getElementById('gender').value;
            const tb = document.getElementById('height').value;
            const bb = document.getElementById('weight').value;
            const ttl = document.getElementById('birthdate').value;
            const kategori = document.getElementById('category').value;

            // Save to Firebase Realtime Database
            const pesertaRef = ref(database, 'peserta/');
            push(pesertaRef, {
                nama: nama,
                jk: jk,
                tb: tb,
                bb: bb,
                ttl: ttl,
                kategori: kategori
            })
            .then(() => {
                messageDiv.style.display = 'block';
                messageDiv.innerHTML = "Data berhasil disimpan! Apakah Anda ingin menginput data lagi? <button id='yes' class='back-button'>Ya</button> <button id='no' class='check-data-button'>Tidak</button>";

                document.getElementById('yes').addEventListener('click', function() {
                    form.reset();
                    messageDiv.style.display = 'none';
                });

                document.getElementById('no').addEventListener('click', function() {
                    window.location.href = 'cekdata.html';
                });
            })
            .catch((error) => {
                console.error("Error saving data: ", error);
                messageDiv.style.display = 'block';
                messageDiv.innerHTML = "Terjadi kesalahan saat menyimpan data.";
            });
        });
    </script>
</body>
</html>
